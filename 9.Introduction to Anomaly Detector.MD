# Introduction to Anomaly Detector
* Discover the services available on Azure to detect anomalies in your time-series, or real-time data.
* Anomaly detection is an AI technique used to determine whether values in a series are within expected parameters.
* There are many scenarios where anomaly detection is helpful. For example, a smart HVAC system might use anomaly detection to monitor temperatures in a building and raise an alert if the temperature goes above or below the expected value for a given period of time.
* Other scenarios include:
    1. monitoring blood pressure
    2. evaluating mean time between failures for hardware products
    3. comparing month-over-month expenses for product costs

# What is Anomaly Detector?
* Anomalies are values that are outside the expected values or range of values.
![](img/9/1.batch-anomaly.png)
* In the graphic depicting the time series data, there is a light shaded area that indicates the boundary, or sensitivity range. The solid blue line is used to indicate the measured values. When a measured value is outside of the shaded boundary, an orange dot is used to indicate the value is considered an anomaly. The sensitivity boundary is a parameter that you can specify when calling the service. It allows you to adjust that boundary settings to tweak the results.
* Anomaly detection is considered the act of identifying events, or observations, that differ in a significant way from the rest of the data being evaluated. Accurate anomaly detection leads to prompt troubleshooting, which helps to avoid revenue loss and maintain brand reputation.

# Azure's Anomaly Detector service
* Anomaly Detector is a part of the Decision Services category within Azure Cognitive Services. It is a cloud-based service that enables you to monitor time series data, and to detect anomalies in that data. It does not require you to know ML. The service uses the concept of a "one parameter" strategy. The main parameter you need to customize is “Sensitivity”, which is from 1 to 99 to adjust the outcome to fit the scenario. The service can detect anomalies in historical time series data and also in real-time data such as streaming input from IoT devices, sensors, or other streaming input sources.

How Anomaly Detector works
Completed
100 XP
10 minutes
The Anomaly Detector service identifies anomalies that exist outside the scope of a boundary. The boundary is set using a sensitivity value. By default, the upper and lower boundaries for anomaly detection are calculated using concepts known as expectedValue, upperMargin, and lowerMargin. The upper and lower boundaries are calculated using these three values. If a value exceeds either boundary, it will be identified as an anomaly. You can adjust the boundaries by applying a marginScale to the upper and lower margins as demonstrated by the following formula.

upperBoundary = expectedValue + (100 - marginScale) * upperMargin

# Data format (JSON) - The granularity is set as hourly and is used to represent temperatures in degrees Celsius that were recorded at the timestamps indicated.
``` mark
    {
        "granularity": "hourly",
        "series": [
          {
            "timestamp": "2021-03-02T01:00:00Z",
            "value": -10.56
          },
          {
            "timestamp": "2021-03-02T02:00:00Z",
            "value": -8.30
          },
          {
            "timestamp": "2021-03-02T03:00:00Z",
            "value": -10.30
          },
          {
            "timestamp": "2021-03-02T04:00:00Z",
            "value": 5.95
          },
        ]
    }
```
* The service will support a maximum of 8640 data points however, sending this many data points in the same JSON object, can result in latency for the response. Improve the response by breaking your data points into smaller chunks (windows) and sending these in a sequence.
* The same JSON object format is used in a streaming scenario. The main difference is that you will send a single value in each request. The streaming detection method will compare the current value being sent and the previous value sent.

# Data consistency recommendations
* If your data may have missing values in the sequence, consider the following recommendations.
    1. Sampling occurs every few minutes and has less than 10% of the expected number of points missing. In this case, the impact should be negligible on the detection results.
    2. If you have more than 10% missing, there are options to help "fill" the data set. Consider using a linear interpolation method to fill in the missing values and complete the data set. This will fill gaps with evenly distributed values.
* The Anomaly Detector service will provide the best results if your time series data is evenly distributed. If the data is more randomly distributed, you can use an aggregation method to create a more even distribution data set.
